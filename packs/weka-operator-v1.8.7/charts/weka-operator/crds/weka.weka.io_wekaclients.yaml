---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.5
  name: wekaclients.weka.weka.io
spec:
  group: weka.weka.io
  names:
    kind: WekaClient
    listKind: WekaClientList
    plural: wekaclients
    singular: wekaclient
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Resource status
      jsonPath: .status.status
      name: Status
      type: string
    - description: Name of the target cluster if exists
      jsonPath: .spec.targetCluster.name
      name: Target Cluster
      type: string
    - description: Number of cores
      jsonPath: .spec.coresNum
      name: Cores
      type: integer
    - description: 'Number of client containers: Active/Created/Desired'
      jsonPath: .status.printer.containers
      name: Containers(A/C/D)
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: WekaClient is the Schema for the clients API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: WekaClientSpec defines the desired state of WekaClient
            properties:
              additionalMemory:
                description: memory to add/decrease from "auto-calculated" memory
                type: integer
              agentPort:
                description: if not set (0), weka will find a free port from the portRange
                type: integer
              allowHotUpgrade:
                type: boolean
              autoRemoveTimeout:
                default: 24h
                description: sets weka cluster-side timeout, if client is not coming
                  back in specified duration it will be auto removed from cluster
                  config
                pattern: ^(0|([0-9]+(\.[0-9]+)?(ns|us|Âµs|ms|s|m|h))+)$
                type: string
              coreIds:
                items:
                  type: integer
                type: array
              coresNum:
                type: integer
              cpuPolicy:
                default: auto
                enum:
                - auto
                - shared
                - dedicated
                - dedicated_ht
                - manual
                type: string
              cpuRequest:
                type: string
              csiConfig:
                description: 'EXPERIMENTAL, ALPHA STATE, should not be used in production:
                  if set, allows to reuse the same csi resources for multiple clients'
                properties:
                  advanced:
                    properties:
                      controllerLabels:
                        additionalProperties:
                          type: string
                        type: object
                      controllerTolerations:
                        items:
                          description: |-
                            The pod this Toleration is attached to tolerates any taint that matches
                            the triple <key,value,effect> using the matching operator <operator>.
                          properties:
                            effect:
                              description: |-
                                Effect indicates the taint effect to match. Empty means match all taint effects.
                                When specified, allowed values are NoSchedule, PreferNoSchedule and NoExecute.
                              type: string
                            key:
                              description: |-
                                Key is the taint key that the toleration applies to. Empty means match all taint keys.
                                If the key is empty, operator must be Exists; this combination means to match all values and all keys.
                              type: string
                            operator:
                              description: |-
                                Operator represents a key's relationship to the value.
                                Valid operators are Exists and Equal. Defaults to Equal.
                                Exists is equivalent to wildcard for value, so that a pod can
                                tolerate all taints of a particular category.
                              type: string
                            tolerationSeconds:
                              description: |-
                                TolerationSeconds represents the period of time the toleration (which must be
                                of effect NoExecute, otherwise this field is ignored) tolerates the taint. By default,
                                it is not set, which means tolerate the taint forever (do not evict). Zero and
                                negative values will be treated as 0 (evict immediately) by the system.
                              format: int64
                              type: integer
                            value:
                              description: |-
                                Value is the taint value the toleration matches to.
                                If the operator is Exists, the value should be empty, otherwise just a regular string.
                              type: string
                          type: object
                        type: array
                      enforceTrustedHttps:
                        type: boolean
                      nodeLabels:
                        additionalProperties:
                          type: string
                        type: object
                      nodeTolerations:
                        items:
                          description: |-
                            The pod this Toleration is attached to tolerates any taint that matches
                            the triple <key,value,effect> using the matching operator <operator>.
                          properties:
                            effect:
                              description: |-
                                Effect indicates the taint effect to match. Empty means match all taint effects.
                                When specified, allowed values are NoSchedule, PreferNoSchedule and NoExecute.
                              type: string
                            key:
                              description: |-
                                Key is the taint key that the toleration applies to. Empty means match all taint keys.
                                If the key is empty, operator must be Exists; this combination means to match all values and all keys.
                              type: string
                            operator:
                              description: |-
                                Operator represents a key's relationship to the value.
                                Valid operators are Exists and Equal. Defaults to Equal.
                                Exists is equivalent to wildcard for value, so that a pod can
                                tolerate all taints of a particular category.
                              type: string
                            tolerationSeconds:
                              description: |-
                                TolerationSeconds represents the period of time the toleration (which must be
                                of effect NoExecute, otherwise this field is ignored) tolerates the taint. By default,
                                it is not set, which means tolerate the taint forever (do not evict). Zero and
                                negative values will be treated as 0 (evict immediately) by the system.
                              format: int64
                              type: integer
                            value:
                              description: |-
                                Value is the taint value the toleration matches to.
                                If the operator is Exists, the value should be empty, otherwise just a regular string.
                              type: string
                          type: object
                        type: array
                      skipGarbageCollection:
                        type: boolean
                    type: object
                  csiGroup:
                    type: string
                  disableControllerCreation:
                    type: boolean
                type: object
              driversDistService:
                type: string
              driversLoaderImage:
                type: string
              globalPVC:
                properties:
                  name:
                    type: string
                  path:
                    type: string
                required:
                - name
                type: object
              hugepages:
                description: hugepages, value in megabytes
                type: integer
              hugepagesOffset:
                description: value in megabytes to offset
                type: integer
              image:
                description: full container image in format of quay.io/weka.io/weka-in-container:VERSION
                pattern: ^.+:\d+\.\d+\.\d+.*$
                type: string
              imagePullSecret:
                type: string
              joinIpPorts:
                items:
                  type: string
                type: array
              network:
                properties:
                  bindManagementAll:
                    description: |-
                      BindManagementAll controls whether Weka containers bind to all network interfaces or only to specific management interfaces.
                      When set to false (default), containers will only listen on the management ips interfaces (restrict_listen mode).
                      When set to true, containers will listen on all ips (0.0.0.0) instead of specific IP addresses.
                    type: boolean
                  deviceSubnets:
                    description: subnet that is used for devices auto-discovery
                    items:
                      pattern: ^([0-9]{1,3}\.){3}[0-9]{1,3}\/[0-9]{1,2}$
                      type: string
                    type: array
                  ethDevice:
                    type: string
                  ethDevices:
                    items:
                      type: string
                    type: array
                  gateway:
                    type: string
                  managementIpsSelectors:
                    items:
                      properties:
                        deviceNames:
                          items:
                            type: string
                          type: array
                        max:
                          type: integer
                        min:
                          type: integer
                        subnet:
                          type: string
                      type: object
                    type: array
                  selectors:
                    items:
                      properties:
                        deviceNames:
                          items:
                            type: string
                          type: array
                        max:
                          type: integer
                        min:
                          type: integer
                        subnet:
                          type: string
                      type: object
                    type: array
                  udpMode:
                    type: boolean
                type: object
              nodeSelector:
                additionalProperties:
                  type: string
                type: object
              overrides:
                properties:
                  forceDrain:
                    description: unsafe operation, forces drain on the node where
                      the container is running, should not be used unless instructed
                      explicitly by weka personnel, the effect of drain is throwing
                      away all IOs and acknowledging all umounts in unsafe manner
                    type: boolean
                  machineIdentifierNodeRef:
                    description: used to override machine identifier node reference
                      for client containers
                    type: string
                  skipActiveMountsCheck:
                    description: option to skip active mounts check before deleting
                      client containers
                    type: boolean
                  umountOnHost:
                    description: unsafe operation, runs nsenter in root namespace
                      to umount all wekafs mounts visible on host
                    type: boolean
                type: object
              port:
                description: if not set (0), weka will find a free port from the portRange
                type: integer
              portRange:
                description: used for dynamic port allocation
                properties:
                  basePort:
                    default: 45000
                    maximum: 65535
                    type: integer
                  portRange:
                    default: 0
                    description: |-
                      number of ports to check for availability
                      if 0 - will check all ports from basePort to 65535
                    type: integer
                required:
                - basePort
                type: object
              rawTolerations:
                items:
                  description: |-
                    The pod this Toleration is attached to tolerates any taint that matches
                    the triple <key,value,effect> using the matching operator <operator>.
                  properties:
                    effect:
                      description: |-
                        Effect indicates the taint effect to match. Empty means match all taint effects.
                        When specified, allowed values are NoSchedule, PreferNoSchedule and NoExecute.
                      type: string
                    key:
                      description: |-
                        Key is the taint key that the toleration applies to. Empty means match all taint keys.
                        If the key is empty, operator must be Exists; this combination means to match all values and all keys.
                      type: string
                    operator:
                      description: |-
                        Operator represents a key's relationship to the value.
                        Valid operators are Exists and Equal. Defaults to Equal.
                        Exists is equivalent to wildcard for value, so that a pod can
                        tolerate all taints of a particular category.
                      type: string
                    tolerationSeconds:
                      description: |-
                        TolerationSeconds represents the period of time the toleration (which must be
                        of effect NoExecute, otherwise this field is ignored) tolerates the taint. By default,
                        it is not set, which means tolerate the taint forever (do not evict). Zero and
                        negative values will be treated as 0 (evict immediately) by the system.
                      format: int64
                      type: integer
                    value:
                      description: |-
                        Value is the taint value the toleration matches to.
                        If the operator is Exists, the value should be empty, otherwise just a regular string.
                      type: string
                  type: object
                type: array
              resources:
                description: 'experimental: pod resources to be proxied as-is to the
                  pod spec'
                properties:
                  limits:
                    properties:
                      cpu:
                        anyOf:
                        - type: integer
                        - type: string
                        pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                        x-kubernetes-int-or-string: true
                      memory:
                        anyOf:
                        - type: integer
                        - type: string
                        pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                        x-kubernetes-int-or-string: true
                    type: object
                  requests:
                    properties:
                      cpu:
                        anyOf:
                        - type: integer
                        - type: string
                        pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                        x-kubernetes-int-or-string: true
                      memory:
                        anyOf:
                        - type: integer
                        - type: string
                        pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                        x-kubernetes-int-or-string: true
                    type: object
                type: object
              serviceAccountName:
                type: string
              targetCluster:
                properties:
                  name:
                    type: string
                  namespace:
                    type: string
                required:
                - name
                - namespace
                type: object
              tolerations:
                items:
                  type: string
                type: array
              tracesConfiguration:
                description: TraceConfiguration defines the configuration for the
                  traces, accepts parameters in gigabytes
                properties:
                  dumperConfigMode:
                    default: auto
                    enum:
                    - override
                    - partial-override
                    - auto
                    - cluster
                    type: string
                  ensureFreeSpace:
                    default: 20
                    type: integer
                  maxCapacityPerIoNode:
                    default: 10
                    type: integer
                type: object
              upgradePolicy:
                properties:
                  type:
                    default: all-at-once
                    enum:
                    - manual
                    - all-at-once
                    - rolling
                    - all-at-once-force
                    type: string
                type: object
              wekaHome:
                properties:
                  cacertSecret:
                    type: string
                type: object
              wekaHomeConfig:
                description: DEPRECATED, kept for compatibility with old API clients,
                  not taking any action, to be removed on new API version
                properties:
                  cacertSecret:
                    type: string
                type: object
              wekaSecretRef:
                type: string
            required:
            - image
            type: object
          status:
            description: WekaClientStatus defines the observed state of WekaClient
            properties:
              conditions:
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              lastAppliedSpec:
                type: string
              printer:
                properties:
                  containers:
                    type: string
                type: object
              stats:
                properties:
                  containers:
                    properties:
                      active:
                        format: int64
                        type: integer
                      created:
                        format: int64
                        type: integer
                      desired:
                        format: int64
                        type: integer
                    type: object
                type: object
              status:
                default: Init
                enum:
                - Init
                - Running
                - Upgrading
                - Destroying
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
